{% extends "main/layout.html" %}
{% block content %}
{% load concat %}
{% load crispy_forms_tags %}

{% comment %} Disabled ajax add/remove formset entry code. Library seemed to flakey, maybe we'll use it later. {% endcomment %}
{% comment %} 
{% load static %}
<script src="{% static 'main/jquery.formset.20201005.min.js' %}"></script>
<script type="text/javascript">
    $(function() {
        $('#generic_object_form tbody tr').formset();
    })
</script> {% endcomment %}

{% comment %} See the failed attempt html for more form customization and stuff trying to use dropzone {% endcomment %}

<script type="text/javascript">
    function deletenote(noteid) {
        var headers = new Headers();
        headers.append('X-CSRFToken', '{{ csrf_token }}');
        fetch('deletenote/'+noteid, {
            method: 'POST',
            headers: headers, 
            credentials: 'include'
        }).then(response => {
            if (response.redirected) {
                window.location.href = response.url;
            }
        })
    }
</script>
<h5 class="my-3"> {{page_header}}: {{root_object_title}} </h5>
<form id="generic_object_form" action="" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {% crispy form helper %}
    {% if obj_type != 'manuscript' %} {% comment %} and note_formset and note_helper | This may lead to view mistakes failing silently {% endcomment %}
        {% include "main/note_list.html" %}    
    {% endif %}
    {% comment %} {% if not read_only %} {% endcomment %}
    <input type="submit" name="submit" value="Save">
    {% comment %} {% endif %} {% endcomment %}
    {% block extrabuttons %}
    {% endblock %}
    <input type=button value="Back" onClick="javascript:history.go(-1);">
</form>
{% comment %}TODO: Move the below stuff to sub-templates and only use them on certain objects{% endcomment %}



{% endblock content %}